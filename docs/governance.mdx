---
title: "Bifrost Governance Plugin"
description: "Comprehensive access control, usage tracking, and cost management for your AI infrastructure with user authorization and spending limits."
---

# Bifrost Governance Plugin

The Bifrost Governance Plugin provides comprehensive access control, usage tracking, and cost management for your AI infrastructure. It enables you to control who can access what models, set spending limits, and track usage across your organization.

## üéØ What is Governance?

Governance in Bifrost ensures that:

- **Only authorized users** can access your AI models
- **Spending stays within budget** through hierarchical cost controls
- **Usage is tracked and monitored** for accountability
- **Rate limits prevent abuse** and ensure fair resource allocation

## üèóÔ∏è Core Concepts

### Virtual Keys (VKs)
Virtual Keys are the fundamental unit of access control in Bifrost. Think of them as "API keys with superpowers":

- **Authentication**: Each request must include a valid Virtual Key
- **Authorization**: VKs can be restricted to specific models and providers
- **Cost Control**: VKs have spending limits and budgets
- **Rate Limiting**: VKs can have request rate limits
- **Usage Tracking**: All usage is tracked per Virtual Key

Virtual Keys replace your real provider API keys in client applications. Instead of exposing your actual OpenAI or Anthropic keys, you distribute Virtual Keys that Bifrost manages.

### Teams
Teams provide organizational structure and budget allocation:

- **Hierarchical Organization**: Teams can have parent-child relationships
- **Budget Management**: Teams have spending limits that cascade to children
- **Member Management**: Control which users belong to which teams
- **Resource Allocation**: Distribute AI resources across teams

### Customers
Customers represent top-level entities in your organization:

- **Multi-tenancy**: Isolate resources between different customers/organizations
- **Billing Aggregation**: Track costs and usage per customer
- **Global Policies**: Apply organization-wide policies and limits

## üöÄ Quick Start

### 1. Enable the Governance Plugin

```bash
# Enable governance in your Bifrost configuration
bifrost-http --plugins governance
```

### 2. Create a Customer

```bash
curl -X POST http://localhost:8080/api/governance/customers \
  -H "Content-Type: application/json" \
  -d '{
    "name": "My Organization",
    "budget_limit_usd": 1000.0,
    "rate_limit_rpm": 10000
  }'
```

### 3. Create a Team

```bash
curl -X POST http://localhost:8080/api/governance/teams \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Engineering Team",
    "customer_id": "customer_123",
    "budget_limit_usd": 500.0,
    "rate_limit_rpm": 5000
  }'
```

### 4. Create a Virtual Key

```bash
curl -X POST http://localhost:8080/api/governance/virtual_keys \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Frontend App Key",
    "team_id": "team_456",
    "budget_limit_usd": 100.0,
    "rate_limit_rpm": 1000,
    "allowed_models": ["openai/gpt-4o-mini", "anthropic/claude-3-sonnet"]
  }'
```

### 5. Use the Virtual Key

```python
import openai

# Use your Virtual Key instead of real API key
client = openai.OpenAI(
    base_url="http://localhost:8080/openai",
    api_key="vk_abc123..."  # Your Virtual Key
)

response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[{"role": "user", "content": "Hello, world!"}]
)
```

## üìä Features

### Access Control
- **Model Restrictions**: Limit which models a Virtual Key can access
- **Provider Restrictions**: Control which AI providers are available
- **Time-based Access**: Set expiration dates for Virtual Keys
- **IP Restrictions**: Limit access to specific IP addresses or ranges

### Cost Management
- **Hierarchical Budgets**: Budgets cascade from Customer ‚Üí Team ‚Üí Virtual Key
- **Real-time Tracking**: Monitor spending in real-time
- **Budget Alerts**: Get notified when approaching limits
- **Cost Allocation**: Track costs across teams and projects

### Usage Monitoring
- **Request Tracking**: Log every API request with metadata
- **Token Usage**: Track input/output tokens for cost analysis
- **Performance Metrics**: Monitor latency and error rates
- **Usage Reports**: Generate detailed usage reports

### Rate Limiting
- **Requests per Minute (RPM)**: Limit API call frequency
- **Tokens per Minute (TPM)**: Limit token consumption rate
- **Burst Handling**: Allow short bursts while maintaining average limits
- **Fair Queuing**: Ensure fair resource allocation

## üîß Configuration

### Environment Variables

```bash
# Database configuration
BIFROST_GOVERNANCE_DB_PATH="/data/governance.db"

# Admin configuration  
BIFROST_GOVERNANCE_ADMIN_ENABLED=true
BIFROST_GOVERNANCE_ADMIN_TOKEN="admin_secret_token"

# Default limits
BIFROST_GOVERNANCE_DEFAULT_BUDGET_USD=100
BIFROST_GOVERNANCE_DEFAULT_RATE_LIMIT_RPM=1000
```

### Configuration File

```json
{
  "plugins": {
    "governance": {
      "enabled": true,
      "db_path": "/data/governance.db",
      "admin": {
        "enabled": true,
        "token": "admin_secret_token"
      },
      "defaults": {
        "budget_limit_usd": 100.0,
        "rate_limit_rpm": 1000
      }
    }
  }
}
```

## üìà Usage Tracking

The governance plugin tracks detailed usage metrics:

### Request Metrics
- **Timestamp**: When the request was made
- **Virtual Key**: Which key was used
- **Model**: Which AI model was called
- **Provider**: Which provider served the request
- **Tokens**: Input and output token counts
- **Cost**: Calculated cost based on provider pricing
- **Latency**: Request duration
- **Status**: Success/failure status

### Aggregated Metrics
- **Daily/Monthly Summaries**: Aggregated usage by time period
- **Team Rollups**: Usage aggregated by team
- **Model Usage**: Which models are most popular
- **Cost Trends**: Spending patterns over time

## üõ°Ô∏è Security Features

### Authentication
- **Virtual Key Validation**: All requests must include valid Virtual Keys
- **Token Rotation**: Support for rotating Virtual Keys
- **Admin Authentication**: Separate admin tokens for management operations

### Authorization
- **Role-based Access**: Different permission levels for users
- **Resource Isolation**: Teams can only access their own resources
- **Audit Logging**: Complete audit trail of all operations

### Data Protection
- **Encrypted Storage**: Sensitive data is encrypted at rest
- **Secure Transmission**: All API calls use HTTPS
- **Key Management**: Secure storage and rotation of API keys

## üîç Monitoring and Alerts

### Real-time Monitoring
- **Usage Dashboard**: Real-time view of current usage
- **Budget Status**: Current spending vs. limits
- **Rate Limit Status**: Current request rates vs. limits
- **Active Keys**: Which Virtual Keys are currently active

### Alerting
- **Budget Alerts**: Notify when approaching spending limits
- **Rate Limit Alerts**: Notify when hitting rate limits
- **Error Alerts**: Notify when error rates spike
- **Security Alerts**: Notify of suspicious activity

## üîÑ Migration and Integration

### Migrating from Direct Provider Access

1. **Identify Current Usage**: Audit your current API key usage
2. **Create Governance Structure**: Set up customers, teams, and budgets
3. **Generate Virtual Keys**: Create Virtual Keys for each application
4. **Update Applications**: Replace real API keys with Virtual Keys
5. **Monitor and Adjust**: Use governance data to optimize usage

### Integration with Existing Systems

The governance plugin provides REST APIs that integrate with:

- **Identity Providers**: LDAP, Active Directory, SSO systems
- **Billing Systems**: Export usage data for billing
- **Monitoring Tools**: Prometheus metrics, Grafana dashboards
- **ITSM Tools**: ServiceNow, Jira for approval workflows

## üìã API Reference

### Virtual Keys API

```bash
# List Virtual Keys
GET /governance/virtual_keys

# Create Virtual Key
POST /governance/virtual_keys
{
  "name": "string",
  "team_id": "string",
  "budget_limit_usd": number,
  "rate_limit_rpm": number,
  "allowed_models": ["string"],
  "expires_at": "2024-12-31T23:59:59Z"
}

# Get Virtual Key
GET /governance/virtual_keys/{id}

# Update Virtual Key
PUT /governance/virtual_keys/{id}

# Delete Virtual Key
DELETE /governance/virtual_keys/{id}
```

### Teams API

```bash
# List Teams
GET /governance/teams

# Create Team
POST /governance/teams
{
  "name": "string",
  "customer_id": "string",
  "parent_team_id": "string",
  "budget_limit_usd": number,
  "rate_limit_rpm": number
}

# Get Team
GET /governance/teams/{id}

# Update Team
PUT /governance/teams/{id}

# Delete Team
DELETE /governance/teams/{id}
```

### Customers API

```bash
# List Customers
GET /governance/customers

# Create Customer
POST /governance/customers
{
  "name": "string",
  "budget_limit_usd": number,
  "rate_limit_rpm": number
}

# Get Customer
GET /governance/customers/{id}

# Update Customer
PUT /governance/customers/{id}

# Delete Customer
DELETE /governance/customers/{id}
```

### Usage API

```bash
# Get Usage Summary
GET /governance/usage/summary?start_date=2024-01-01&end_date=2024-01-31

# Get Usage by Virtual Key
GET /governance/usage/virtual_keys/{id}?start_date=2024-01-01&end_date=2024-01-31

# Get Usage by Team
GET /governance/usage/teams/{id}?start_date=2024-01-01&end_date=2024-01-31

# Get Usage by Customer
GET /governance/usage/customers/{id}?start_date=2024-01-01&end_date=2024-01-31
```

## üè¢ Enterprise Features

### Advanced Access Control
- **IP Whitelisting**: Restrict access to specific IP ranges
- **Time-based Access**: Allow access only during business hours
- **Geographic Restrictions**: Limit access by geographic region
- **Device Fingerprinting**: Track and control device access

### Compliance and Auditing
- **SOC 2 Compliance**: Detailed audit trails and controls
- **GDPR Support**: Data privacy and retention controls
- **Compliance Reporting**: Generate compliance reports
- **Data Residency**: Control where data is stored and processed

### Advanced Analytics
- **Predictive Analytics**: Forecast usage and costs
- **Anomaly Detection**: Detect unusual usage patterns
- **Chargeback Reporting**: Allocate costs to business units
- **ROI Analysis**: Measure return on AI investments

## üöÄ Getting Started

1. **[Quick Start Guide](quickstart/)** - Get governance running in 5 minutes
2. **[Architecture Overview](architecture/)** - Understand how governance works
3. **[API Documentation](usage/http-transport/)** - Complete API reference
4. **[Best Practices](contributing/)** - Learn governance best practices

## üí° Use Cases

### Startup/Small Company
- **Simple Access Control**: Basic Virtual Keys for different applications
- **Budget Monitoring**: Track AI spending across the company
- **Developer Access**: Give developers controlled access to AI models

### Enterprise
- **Multi-tenant Architecture**: Separate customers with complete isolation
- **Hierarchical Teams**: Complex organizational structures with cascading budgets
- **Compliance Requirements**: Meet enterprise security and compliance needs
- **Cost Allocation**: Charge different business units for AI usage

### AI Service Provider
- **Customer Management**: Manage multiple customer organizations
- **Usage-based Billing**: Accurate tracking for billing customers
- **Rate Limiting**: Prevent abuse and ensure fair usage
- **White-label Solutions**: Customize for your customers

---

> **üí° New to Bifrost?** Start with the [main documentation](/) to understand Bifrost's core concepts before configuring governance.
