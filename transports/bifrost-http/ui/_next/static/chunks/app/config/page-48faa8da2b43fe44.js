(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[653],{12:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ey});var n=t(5155),a=t(2115),r=t(4964),i=t(8145),l=t(4213),c=t(1539),o=t(381),d=t(6671);function u(){return{toast:e=>{let{title:s,description:t,variant:n}=e,a=t?"".concat(s,": ").concat(t):s;"destructive"===n?d.o.error(a):d.o.success(a)}}}var m=t(1886),x=t(8482),h=t(4884),p=t(3999);let g=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)(h.bL,{className:(0,p.cn)("peer focus-visible:ring-ring focus-visible:ring-offset-background data-[state=checked]:bg-primary data-[state=unchecked]:bg-input inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),...a,ref:s,children:(0,n.jsx)(h.zi,{className:(0,p.cn)("bg-background pointer-events-none block h-5 w-5 rounded-full shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});g.displayName=h.bL.displayName;var f=t(1154),j=t(1243),v=t(7489),y=t(9026),b=t(9852);function N(e){let{className:s,...t}=e;return(0,n.jsx)("textarea",{"data-slot":"textarea",className:(0,p.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),...t})}let _=e=>e.split(",").map(e=>e.trim()).filter(e=>e.length>0),C=(e,s)=>(null==e?void 0:e.length)===(null==s?void 0:s.length)&&(null==e?void 0:e.every((e,t)=>e===s[t]));function w(){let[e,s]=(0,a.useState)({drop_excess_requests:!1,initial_pool_size:300,enable_logging:!0}),[t,r]=(0,a.useState)(0),[i,l]=(0,a.useState)(!0),[c,o]=(0,a.useState)({initial_pool_size:"300",prometheus_labels:""});(0,a.useEffect)(()=>{(async()=>{let[e,s]=await m.K.getDroppedRequests();s?d.o.error(s):e&&r(e.dropped_requests)})()},[]);let u=(0,a.useRef)(void 0),h=(0,a.useRef)(void 0);(0,a.useEffect)(()=>{(async()=>{let[e,t]=await m.K.getCoreConfig();if(t)d.o.error(t);else if(e){var n;s(e),o({initial_pool_size:(null==(n=e.initial_pool_size)?void 0:n.toString())||"300",prometheus_labels:e.prometheus_labels||""})}l(!1)})()},[]);let p=(0,a.useCallback)(async(t,n)=>{let a={...e,[t]:n};s(a);let[,r]=await m.K.updateCoreConfig(a);r?d.o.error(r):d.o.success("Core setting updated successfully.")},[e]),C=async(e,s)=>{await p(e,s)},w=(0,a.useCallback)(e=>{o(s=>({...s,initial_pool_size:e})),u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{let s=Number.parseInt(e);!isNaN(s)&&s>0&&p("initial_pool_size",s)},1e3)},[p]),k=(0,a.useCallback)(e=>{o(s=>({...s,prometheus_labels:e})),h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{p("prometheus_labels",_(e))},1e3)},[p]);return((0,a.useEffect)(()=>()=>{u.current&&clearTimeout(u.current),h.current&&clearTimeout(h.current)},[]),i)?(0,n.jsx)("div",{className:"flex h-64 items-center justify-center",children:(0,n.jsx)(f.A,{className:"h-4 w-4 animate-spin"})}):(0,n.jsxs)("div",{children:[(0,n.jsxs)(x.aR,{className:"mb-4 px-0",children:[(0,n.jsx)(x.ZB,{className:"flex items-center gap-2",children:"Core System Settings"}),(0,n.jsx)(x.BT,{children:"Configure core Bifrost settings like request handling, pool sizes, and system behavior."})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between space-x-2 rounded-lg border p-4",children:[(0,n.jsxs)("div",{className:"space-y-0.5",children:[(0,n.jsx)("label",{htmlFor:"drop-excess-requests",className:"text-sm font-medium",children:"Drop Excess Requests"}),(0,n.jsx)("p",{className:"text-muted-foreground text-sm",children:"If enabled, Bifrost will drop requests that exceed pool capacity."})]}),(0,n.jsx)(g,{id:"drop-excess-requests",checked:e.drop_excess_requests,onCheckedChange:e=>C("drop_excess_requests",e)})]}),(0,n.jsx)(v.w,{}),(0,n.jsxs)(y.Fc,{children:[(0,n.jsx)(j.A,{className:"h-4 w-4"}),(0,n.jsx)(y.TN,{children:"The settings below require a Bifrost service restart to take effect. Current connections will continue with existing settings until restart."})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between space-x-2 rounded-lg border p-4",children:[(0,n.jsxs)("div",{className:"space-y-0.5",children:[(0,n.jsx)("label",{htmlFor:"initial-pool-size",className:"text-sm font-medium",children:"Initial Pool Size"}),(0,n.jsx)("p",{className:"text-muted-foreground text-sm",children:"The initial connection pool size."})]}),(0,n.jsx)(b.p,{id:"initial-pool-size",type:"number",className:"w-24",value:c.initial_pool_size,onChange:e=>w(e.target.value),min:"1"})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between space-x-2 rounded-lg border p-4",children:[(0,n.jsxs)("div",{className:"space-y-0.5",children:[(0,n.jsx)("label",{htmlFor:"enable-logging",className:"text-sm font-medium",children:"Enable Logs"}),(0,n.jsx)("p",{className:"text-muted-foreground text-sm",children:"Enable logging of requests and responses to a SQLite database. This can add 40-60mb of overhead to the system memory."})]}),(0,n.jsx)(g,{id:"enable-logging",checked:e.enable_logging,onCheckedChange:e=>C("enable_logging",e)})]}),(0,n.jsxs)("div",{className:"space-y-2 rounded-lg border p-4",children:[(0,n.jsxs)("div",{className:"space-y-0.5",children:[(0,n.jsx)("label",{htmlFor:"prometheus-labels",className:"text-sm font-medium",children:"Prometheus Labels"}),(0,n.jsx)("p",{className:"text-muted-foreground text-sm",children:"Comma-separated list of custom labels to add to the Prometheus metrics."})]}),(0,n.jsx)(N,{id:"prometheus-labels",className:"h-24",placeholder:"teamId, projectId, environment",value:c.prometheus_labels,onChange:e=>k(e.target.value)})]})]})]})}var k=t(7168),A=t(8524),S=t(4616),P=t(9803),z=t(3717),E=t(2525),q=t(7783),I=t(7649);function V(e){let{...s}=e;return(0,n.jsx)(I.bL,{"data-slot":"alert-dialog",...s})}function R(e){let{...s}=e;return(0,n.jsx)(I.l9,{"data-slot":"alert-dialog-trigger",...s})}function T(e){let{...s}=e;return(0,n.jsx)(I.ZL,{"data-slot":"alert-dialog-portal",...s})}function M(e){let{className:s,...t}=e;return(0,n.jsx)(I.hJ,{"data-slot":"alert-dialog-overlay",className:(0,p.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t})}function B(e){let{className:s,...t}=e;return(0,n.jsxs)(T,{children:[(0,n.jsx)(M,{}),(0,n.jsx)(I.UC,{"data-slot":"alert-dialog-content",className:(0,p.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...t})]})}function L(e){let{className:s,...t}=e;return(0,n.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,p.cn)("flex flex-col gap-2 text-center sm:text-left",s),...t})}function O(e){let{className:s,...t}=e;return(0,n.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,p.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...t})}function D(e){let{className:s,...t}=e;return(0,n.jsx)(I.hE,{"data-slot":"alert-dialog-title",className:(0,p.cn)("text-lg font-semibold",s),...t})}function $(e){let{className:s,...t}=e;return(0,n.jsx)(I.VY,{"data-slot":"alert-dialog-description",className:(0,p.cn)("text-muted-foreground text-sm",s),...t})}function U(e){let{className:s,...t}=e;return(0,n.jsx)(I.rc,{className:(0,p.cn)((0,k.r)({variant:"destructive"}),s),...t})}function K(e){let{className:s,...t}=e;return(0,n.jsx)(I.ZD,{className:(0,p.cn)((0,k.r)({variant:"outline"}),s),...t})}var Z=t(5784),F=t(9840),H=t(7777),J=t(4416);let Y=a.forwardRef((e,s)=>{let{className:t,value:r,onValueChange:l,...c}=e,[o,d]=a.useState(""),u=e=>{l(r.filter(s=>s!==e))};return(0,n.jsxs)("div",{className:(0,p.cn)("border-input flex flex-wrap items-center gap-2 rounded-md border p-2",t),children:[r.map(e=>(0,n.jsxs)(i.E,{variant:"secondary",className:"flex items-center gap-1",children:[e,(0,n.jsx)("button",{type:"button",className:"ring-offset-background focus:ring-ring cursor-pointer rounded-full outline-none focus:ring-2 focus:ring-offset-2",onClick:()=>u(e),children:(0,n.jsx)(J.A,{className:"h-3 w-3"})})]},e)),(0,n.jsx)(b.p,{ref:s,type:"text",value:o,onChange:e=>{d(e.target.value)},onKeyDown:e=>{if("Enter"===e.key||","===e.key){e.preventDefault();let s=o.trim();s&&!r.includes(s)&&l([...r,s]),d("")}else"Backspace"===e.key&&""===o&&r.length>0&&l(r.slice(0,-1))},className:"flex-1 border-0 shadow-none focus-visible:ring-0",...c})]})});Y.displayName="TagInput";var G=t(1284),W=t(4869),X=t(4229),Q=t(9231),ee=t.n(Q),es=t(8103);let et={azure:{title:"Azure OpenAI Meta Config",fields:[{name:"endpoint",label:"Endpoint",type:"text",placeholder:"https://your-resource.openai.azure.com or env.AZURE_ENDPOINT"},{name:"api_version",label:"API Version (Optional)",type:"text",placeholder:"YYYY-MM-DD or env.AZURE_VERSION"},{name:"deployments",label:"Deployments (JSON format)",type:"textarea",placeholder:'{ "gpt-4": "my-deployment" }',isJson:!0}]},bedrock:{title:"AWS Bedrock Meta Config",fields:[{name:"region",label:"Region",type:"text",placeholder:"us-east-1 or env.AWS_REGION"}]},vertex:{title:"Google Vertex AI Meta Config",fields:[{name:"project_id",label:"Project ID",type:"text",placeholder:"gcp-project-id or env.GCP_PROJECT"},{name:"region",label:"Region",type:"text",placeholder:"us-central1 or env.GCP_REGION"},{name:"auth_credentials",label:"Auth Credentials (JSON key)",type:"textarea",placeholder:"JSON key or env.GCP_CREDS"}]}},en=e=>{let{provider:s,metaConfig:t,onMetaConfigChange:a}=e,r=et[s];if(!r)return null;let i=e=>{let s=t[e.name];return"textarea"===e.type?(0,n.jsx)(N,{placeholder:e.placeholder,value:e.isJson?"string"==typeof s?s:JSON.stringify(s,null,2):s||"",onChange:s=>{a(e.name,s.target.value)},onBlur:s=>{if(e.isJson)try{let t=JSON.parse(s.target.value);a(e.name,t)}catch(e){}},rows:4,className:"max-w-full font-mono text-sm wrap-anywhere"}):(0,n.jsx)(b.p,{placeholder:e.placeholder,value:s||"",onChange:s=>a(e.name,s.target.value)})};return(0,n.jsxs)("div",{className:"",children:[(0,n.jsx)(x.aR,{className:"mb-2 px-0",children:(0,n.jsxs)(x.ZB,{className:"flex items-center gap-2 text-base",children:[(0,n.jsx)(es.A,{className:"h-4 w-4"}),r.title,(0,n.jsx)(H.Bc,{children:(0,n.jsxs)(H.m_,{children:[(0,n.jsx)(H.k$,{asChild:!0,children:(0,n.jsx)("span",{children:(0,n.jsx)(G.A,{className:"text-muted-foreground ml-1 h-3 w-3"})})}),(0,n.jsx)(H.ZI,{className:"max-w-fit",children:(0,n.jsxs)("p",{children:["Use ",(0,n.jsx)("code",{className:"rounded bg-neutral-100 px-1 py-0.5 text-neutral-800",children:"env.<VAR>"})," to read the value from an environment variable."]})})]})})]})}),(0,n.jsx)(x.Wu,{className:"space-y-4 px-0",children:r.fields.map(e=>(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium",children:e.label}),i(e)]},e.name))})]})};class ea{isValid(){return!this.rules.some(e=>!e.isValid)}getErrors(){return this.rules.filter(e=>!e.isValid).map(e=>e.message)}getFirstError(){let e=this.rules.find(e=>!e.isValid);return null==e?void 0:e.message}static required(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"This field is required";return{isValid:null!=e&&""!==e&&0!==e,message:s}}static minValue(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Must be at least ".concat(s);return{isValid:!isNaN(e)&&e>=s,message:t}}static maxValue(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Must be at most ".concat(s);return{isValid:!isNaN(e)&&e<=s,message:t}}static pattern(e,s,t){return{isValid:s.test(e||""),message:t}}static email(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Must be a valid email";return this.pattern(e,/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,s)}static url(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Must be a valid URL";return this.pattern(e,/^https?:\/\/.+/,s)}static minLength(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Must be at least ".concat(s," characters");return{isValid:(e||"").length>=s,message:t}}static maxLength(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Must be at most ".concat(s," characters");return{isValid:(e||"").length<=s,message:t}}static arrayMinLength(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Must have at least ".concat(s," items");return{isValid:(null==e?void 0:e.length)>=s,message:t}}static arrayMaxLength(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Must have at most ".concat(s," items");return{isValid:(null==e?void 0:e.length)<=s,message:t}}static arrayUnique(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Must have unique items";return{isValid:(null==e?void 0:e.length)===new Set(e).size,message:s}}static arraysEqual(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Must be equal";return{isValid:(null==e?void 0:e.length)===(null==s?void 0:s.length)&&(null==e?void 0:e.every((e,t)=>e===s[t])),message:t}}static custom(e,s){return{isValid:e,message:s}}static all(e){return e.find(e=>!e.isValid)||{isValid:!0,message:""}}constructor(e){this.rules=e.filter(e=>void 0!==e)}}var er=t(4432);let ei={base_url:"",default_request_timeout_in_seconds:30,max_retries:0,retry_backoff_initial:1e3,retry_backoff_max:1e4},el={concurrency:10,buffer_size:100},ec={connected:"bg-green-100 text-green-800",error:"bg-red-100 text-red-800",disconnected:"bg-gray-100 text-gray-800"},eo=(e,s)=>{let t=!e,n=(null==e?void 0:e.name)||s||"",a=!["vertex","ollama"].includes(n);return{selectedProvider:n,keys:t&&a?[{value:"",models:[],weight:1}]:!t&&a&&(null==e?void 0:e.keys)?e.keys:[],networkConfig:(null==e?void 0:e.network_config)||ei,performanceConfig:(null==e?void 0:e.concurrency_and_buffer_size)||el,metaConfig:(null==e?void 0:e.meta_config)||{endpoint:"",deployments:{},api_version:""},proxyConfig:(null==e?void 0:e.proxy_config)||{type:"none",url:"",username:"",password:""}}};function ed(e){var s,t;let{provider:i,onSave:l,onCancel:o,existingProviders:u}=e,x=i?void 0:q.xq.find(e=>!u.includes(e))||"",[h]=(0,a.useState)(eo(i,x)),[g,f]=(0,a.useState)({...h,isDirty:!1}),[v,N]=(0,a.useState)(!1),{selectedProvider:_,keys:C,networkConfig:w,performanceConfig:A,metaConfig:z,proxyConfig:E,isDirty:I}=g,V="ollama"===_,R=!["vertex","ollama"].includes(_);R&&C.every(e=>""!==e.value.trim()),R&&C.length;let T=A.concurrency>0&&A.buffer_size>0&&A.concurrency<A.buffer_size,M=A.concurrency!==h.performanceConfig.concurrency||A.buffer_size!==h.performanceConfig.buffer_size,{valid:B,message:L}=(()=>{let e=!0,s="";if("azure"===_){let t=!!z.endpoint&&""!==z.endpoint.trim(),n=!!(z.deployments&&"object"==typeof z.deployments&&Object.keys(z.deployments).length>0);(e=t&&n)||(s="Endpoint and at least one Deployment are required for Azure")}else if("bedrock"===_)(e=!!z.region&&""!==z.region.trim())||(s="Region is required for AWS Bedrock");else if("vertex"===_){let t=!!z.project_id&&""!==z.project_id.trim(),n=!!z.auth_credentials&&""!==z.auth_credentials.trim(),a=!!z.region&&""!==z.region.trim();(e=t&&n&&a)||(s="Project ID, Auth Credentials, and Region are required for Vertex AI")}return{valid:e,message:s}})();(0,a.useEffect)(()=>{let e={selectedProvider:_,keys:R?C:[],networkConfig:w,performanceConfig:A,metaConfig:z,proxyConfig:E};f(s=>({...s,isDirty:!ee()(h,e)}))},[_,C,w,A,z,E,h,R]);let O=(e,s)=>{f(t=>({...t,[e]:s}))},D=(e,s)=>{O("proxyConfig",{...E,[e]:s})},$=i?q.xq:q.xq.filter(e=>!u.includes(e)),U=async e=>{if(!K.isValid())return void d.o.error(K.getFirstError());e.preventDefault(),N(!0);let s=null;if(i){let e={keys:R?C.filter(e=>""!==e.value.trim()):[],network_config:w,concurrency_and_buffer_size:A,meta_config:z,proxy_config:E};[,s]=await m.K.updateProvider(i.name,e)}else{let e={provider:_,keys:R?C.filter(e=>""!==e.value.trim()):[],network_config:w,concurrency_and_buffer_size:A,meta_config:z,proxy_config:E};[,s]=await m.K.createProvider(e)}N(!1),s?d.o.error(s):(d.o.success("Provider ".concat(i?"updated":"added"," successfully")),l())},K=new ea([ea.required(_,"Please select a provider"),ea.custom(I,"No changes to save"),...V?[ea.required(w.base_url,"Base URL is required for Ollama provider"),ea.pattern(w.base_url||"",/^https?:\/\/.+/,"Base URL must start with http:// or https://")]:[],...R?[ea.minValue(C.length,1,"At least one API key is required"),ea.custom(C.every(e=>""!==e.value.trim()),"API key value cannot be empty")]:[],ea.minValue(w.default_request_timeout_in_seconds,1,"Timeout must be greater than 0 seconds"),ea.minValue(w.max_retries,0,"Max retries cannot be negative"),ea.minValue(A.concurrency,1,"Concurrency must be greater than 0"),ea.minValue(A.buffer_size,1,"Buffer size must be greater than 0"),ea.custom(A.concurrency<A.buffer_size,"Buffer size must be greater than concurrency"),ea.custom(B,L),..."azure"===_?[ea.required(z.endpoint,"Azure endpoint is required"),ea.minValue(Object.keys(z.deployments||{}).length,1,"At least one Azure deployment is required")]:[],..."bedrock"===_?[ea.required(z.region,"AWS region is required")]:[],..."vertex"===_?[ea.required(z.project_id,"Project ID is required for Vertex AI"),ea.required(z.auth_credentials,"Auth credentials are required for Vertex AI"),ea.required(z.region,"Region is required for Vertex AI")]:[]]),Q=e=>{O("keys",C.filter((s,t)=>t!==e))},es=(e,s,t)=>{let n=[...C],a={...n[e]};"models"===s&&Array.isArray(t)?a.models=t:"value"===s&&"string"==typeof t?a.value=t:"weight"===s&&"string"==typeof t&&(a.weight=parseFloat(t)||1),n[e]=a,O("keys",n)},et=(0,a.useMemo)(()=>{let e=[];return R&&e.push({id:"api-keys",label:"API Keys"}),("azure"===_||"bedrock"===_||"vertex"===_)&&e.push({id:"meta-config",label:"Meta Config"}),e.push({id:"network",label:"Network"}),e.push({id:"performance",label:"Performance"}),e},[R,_]),[ei,el]=(0,a.useState)((null==(s=et[0])?void 0:s.id)||"api-keys");return(0,a.useEffect)(()=>{if(!et.map(e=>e.id).includes(ei)){var e;el((null==(e=et[0])?void 0:e.id)||"api-keys")}},[et]),(0,n.jsx)(F.lG,{open:!0,onOpenChange:o,children:(0,n.jsxs)(F.Cf,{className:"custom-scrollbar max-h-[90vh] overflow-y-auto sm:max-w-3xl",children:[(0,n.jsxs)(F.c7,{children:[(0,n.jsx)(F.L3,{children:i?(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,er.FO)(i.name,{size:20}),(0,n.jsx)("span",{className:"font-semibold",children:q.oU[i.name]})]}):(0,n.jsx)("div",{className:"flex items-center gap-2",children:"Add Provider"})}),(0,n.jsx)(F.rr,{children:"Configure AI provider settings, API keys, and network options."})]}),(0,n.jsxs)("form",{onSubmit:U,className:"space-y-6",children:[!i&&(0===$.length?(0,n.jsx)("div",{className:"text-muted-foreground py-8 text-center font-medium",children:"All providers have been configured."}):(0,n.jsx)(H.Bc,{children:(0,n.jsx)("div",{className:"grid grid-cols-4 gap-4",children:q.xq.map(e=>(0,n.jsxs)(H.m_,{children:[(0,n.jsx)(H.k$,{className:(0,p.cn)("flex w-full items-center gap-2 rounded-lg border px-4 py-3 text-sm",_===e?"border-primary/20 opacity-100 hover:opacity-100":$.includes(e)?"cursor-pointer border-transparent opacity-100 hover:shadow-sm dark:shadow-gray-700":"cursor-not-allowed border-transparent opacity-30"),onClick:s=>{s.preventDefault(),$.includes(e)&&O("selectedProvider",e)},asChild:!0,children:(0,n.jsxs)("span",{children:[(0,er.FO)(e,{size:"sm"}),(0,n.jsx)("div",{className:"text-sm",children:q.oU[e]})]})}),!$.includes(e)&&(0,n.jsx)(H.ZI,{children:"Provider is already configured"})]},e))})})),(0,n.jsxs)(r.tU,{defaultValue:null==(t=et[0])?void 0:t.id,value:ei,onValueChange:el,className:"space-y-6",children:[(0,n.jsx)(r.j7,{className:"grid h-10 w-full grid-cols-".concat(et.length," mb-4"),children:et.map(e=>(0,n.jsx)(r.Xi,{value:e.id,className:"flex items-center gap-2",children:e.label},e.id))}),R&&(0,n.jsxs)(r.av,{value:"api-keys",className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(P.A,{className:"h-4 w-4"}),(0,n.jsx)("h3",{className:"text-base font-medium",children:"API Keys"}),(0,n.jsx)(H.Bc,{children:(0,n.jsxs)(H.m_,{children:[(0,n.jsx)(H.k$,{asChild:!0,children:(0,n.jsx)("span",{children:(0,n.jsx)(G.A,{className:"text-muted-foreground ml-1 h-3 w-3"})})}),(0,n.jsx)(H.ZI,{className:"max-w-fit",children:(0,n.jsxs)("p",{children:["Use ",(0,n.jsx)("code",{className:"rounded bg-neutral-100 px-1 py-0.5 text-neutral-800",children:"env.<VAR>"})," to read the value from an environment variable."]})})]})})]}),(0,n.jsxs)(k.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{O("keys",[...C,{value:"",models:[],weight:1}])},children:[(0,n.jsx)(S.A,{className:"h-4 w-4"}),"Add Key"]})]}),(0,n.jsx)("div",{className:"space-y-4",children:C.map((e,s)=>(0,n.jsxs)("div",{className:"space-y-4 rounded-md border p-4",children:[(0,n.jsxs)("div",{className:"flex gap-4",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("div",{className:"text-sm font-medium",children:"API Key"}),(0,n.jsx)(b.p,{placeholder:"API Key or env.MY_KEY",value:e.value,onChange:e=>es(s,"value",e.target.value),type:"text",className:"flex-1 ".concat(R&&""===e.value.trim()?"border-destructive":"")})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"Weight"}),(0,n.jsx)(H.Bc,{children:(0,n.jsxs)(H.m_,{children:[(0,n.jsx)(H.k$,{asChild:!0,children:(0,n.jsx)("span",{children:(0,n.jsx)(G.A,{className:"text-muted-foreground h-3 w-3"})})}),(0,n.jsx)(H.ZI,{children:(0,n.jsx)("p",{children:"Determines traffic distribution between keys. Higher weights receive more requests."})})]})})]}),(0,n.jsx)(b.p,{placeholder:"1.0",value:e.weight,onChange:e=>es(s,"weight",e.target.value),type:"number",step:"0.1",min:"0",max:"1.0",className:"w-20"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"Models (Optional)"}),(0,n.jsx)(H.Bc,{children:(0,n.jsxs)(H.m_,{children:[(0,n.jsx)(H.k$,{asChild:!0,children:(0,n.jsx)("span",{children:(0,n.jsx)(G.A,{className:"text-muted-foreground h-3 w-3"})})}),(0,n.jsx)(H.ZI,{children:(0,n.jsx)("p",{children:"Comma-separated list of models this key applies to. Leave blank for all models."})})]})})]}),(0,n.jsx)(Y,{placeholder:"e.g. gpt-4, gpt-3.5-turbo",value:e.models||[],onValueChange:e=>es(s,"models",e)})]}),C.length>1&&(0,n.jsxs)(k.$,{type:"button",variant:"destructive",size:"sm",onClick:()=>Q(s),className:"mt-2",children:[(0,n.jsx)(J.A,{className:"h-4 w-4"}),"Remove Key"]})]},s))})]}),"anthropic"!==_&&"openai"!==_&&"cohere"!==_&&(0,n.jsx)(r.av,{value:"meta-config",children:(0,n.jsx)(en,{provider:_,metaConfig:z,onMetaConfigChange:(e,s)=>{O("metaConfig",{...z,[e]:s})}})}),(0,n.jsxs)(r.av,{value:"network",className:"space-y-6",children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(W.A,{className:"h-4 w-4"}),(0,n.jsx)("h3",{className:"text-base font-medium",children:"Network Configuration"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{className:"text-sm font-medium",children:["Base URL ",V?"(Required)":"(Optional)"]}),(0,n.jsx)(b.p,{placeholder:"https://api.example.com",value:w.base_url||"",onChange:e=>O("networkConfig",{...w,base_url:e.target.value}),className:V&&!w.base_url?"border-destructive":""})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"Timeout (seconds)"}),(0,n.jsx)(b.p,{type:"number",placeholder:"30",value:w.default_request_timeout_in_seconds,onChange:e=>O("networkConfig",{...w,default_request_timeout_in_seconds:parseInt(e.target.value)||30})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"Max Retries"}),(0,n.jsx)(b.p,{type:"number",placeholder:"0",value:w.max_retries,onChange:e=>O("networkConfig",{...w,max_retries:parseInt(e.target.value)||0})})]})]})]})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(W.A,{className:"h-4 w-4"}),(0,n.jsx)("h3",{className:"text-base font-medium",children:"Proxy Settings"})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"Proxy Type"}),(0,n.jsxs)(Z.l6,{value:E.type,onValueChange:e=>D("type",e),children:[(0,n.jsx)(Z.bq,{className:"w-48",children:(0,n.jsx)(Z.yv,{placeholder:"Select type"})}),(0,n.jsxs)(Z.gC,{children:[(0,n.jsx)(Z.eb,{value:"none",children:"None"}),(0,n.jsx)(Z.eb,{value:"http",children:"HTTP"}),(0,n.jsx)(Z.eb,{value:"socks5",children:"SOCKS5"}),(0,n.jsx)(Z.eb,{value:"environment",children:"Environment"})]})]})]}),"none"!==E.type&&"environment"!==E.type&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"Proxy URL"}),(0,n.jsx)(b.p,{placeholder:"http://proxy.example.com",value:E.url||"",onChange:e=>D("url",e.target.value)})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"Username"}),(0,n.jsx)(b.p,{value:E.username||"",onChange:e=>D("username",e.target.value),placeholder:"Proxy username"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"Password"}),(0,n.jsx)(b.p,{type:"password",value:E.password||"",onChange:e=>D("password",e.target.value),placeholder:"Proxy password"})]})]})]})]})]})]}),(0,n.jsxs)(r.av,{value:"performance",className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(c.A,{className:"h-4 w-4"}),(0,n.jsx)("h3",{className:"text-base font-medium",children:"Performance Settings"})]}),M&&(0,n.jsxs)(y.Fc,{children:[(0,n.jsx)(j.A,{className:"h-4 w-4"}),(0,n.jsxs)(y.TN,{children:[(0,n.jsx)("strong",{children:"Heads up:"})," Changing concurrency or buffer size may temporarily affect request latency for this provider while the new settings are being applied."]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"Concurrency"}),(0,n.jsx)(b.p,{type:"number",value:A.concurrency,onChange:e=>O("performanceConfig",{...A,concurrency:parseInt(e.target.value)||0}),className:T?"":"border-destructive"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-sm font-medium",children:"Buffer Size"}),(0,n.jsx)(b.p,{type:"number",value:A.buffer_size,onChange:e=>O("performanceConfig",{...A,buffer_size:parseInt(e.target.value)||0}),className:T?"":"border-destructive"})]})]})]})]}),$.length>0&&(0,n.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,n.jsx)(k.$,{type:"button",variant:"outline",onClick:o,children:"Cancel"}),(0,n.jsx)(H.Bc,{children:(0,n.jsxs)(H.m_,{children:[(0,n.jsx)(H.k$,{asChild:!0,children:(0,n.jsx)("span",{children:(0,n.jsxs)(k.$,{type:"submit",disabled:!K.isValid()||v,isLoading:v,children:[(0,n.jsx)(X.A,{className:"h-4 w-4"}),v?"Saving...":"Save Provider"]})})}),(!K.isValid()||v)&&(0,n.jsx)(H.ZI,{children:(0,n.jsx)("p",{children:v?"Saving...":K.getFirstError()||"Please fix validation errors"})})]})})]})]})]})})}function eu(e){let{providers:s,onRefresh:t}=e,[r,l]=(0,a.useState)(!1),[c,o]=(0,a.useState)(null),[u,h]=(0,a.useState)(null),p=async e=>{h(e);let[,s]=await m.K.deleteProvider(e);h(null),s?d.o.error(s):(d.o.success("Provider deleted successfully"),t())},g=e=>{o(e),l(!0)};return(0,n.jsxs)(n.Fragment,{children:[r&&(0,n.jsx)(ed,{provider:c,onSave:()=>{l(!1),o(null),t()},onCancel:()=>l(!1),existingProviders:s.map(e=>e.name)}),(0,n.jsxs)(x.aR,{className:"mb-4 px-0",children:[(0,n.jsxs)(x.ZB,{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"flex items-center gap-2",children:"AI Providers"}),(0,n.jsxs)(k.$,{onClick:()=>{o(null),l(!0)},children:[(0,n.jsx)(S.A,{className:"h-4 w-4"}),"Add Provider"]})]}),(0,n.jsx)(x.BT,{children:"Manage AI model providers, their API keys, and configuration settings."})]}),(0,n.jsx)("div",{className:"rounded-md border",children:(0,n.jsxs)(A.XI,{children:[(0,n.jsx)(A.A0,{children:(0,n.jsxs)(A.Hj,{children:[(0,n.jsx)(A.nd,{children:"Provider"}),(0,n.jsx)(A.nd,{children:"Concurrency"}),(0,n.jsx)(A.nd,{children:"Buffer Size"}),(0,n.jsx)(A.nd,{children:"Max Retries"}),(0,n.jsx)(A.nd,{children:"API Keys"}),(0,n.jsx)(A.nd,{className:"text-right",children:"Actions"})]})}),(0,n.jsxs)(A.BF,{children:[0===s.length&&(0,n.jsx)(A.Hj,{children:(0,n.jsx)(A.nA,{colSpan:6,className:"py-6 text-center",children:"No providers found."})}),s.map(e=>{var s,t,a,r;return(0,n.jsxs)(A.Hj,{children:[(0,n.jsx)(A.nA,{children:(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,er.FO)(e.name,{size:16}),(0,n.jsx)("p",{className:"font-medium",children:q.oU[e.name]||e.name})]})}),(0,n.jsx)(A.nA,{children:(0,n.jsx)("div",{className:"flex items-center space-x-2",children:(0,n.jsx)(i.E,{variant:"outline",children:(null==(s=e.concurrency_and_buffer_size)?void 0:s.concurrency)||1})})}),(0,n.jsx)(A.nA,{children:(0,n.jsx)("div",{className:"flex items-center space-x-2",children:(0,n.jsx)(i.E,{variant:"outline",children:(null==(t=e.concurrency_and_buffer_size)?void 0:t.buffer_size)||10})})}),(0,n.jsx)(A.nA,{children:(0,n.jsx)("div",{className:"flex items-center space-x-2",children:(0,n.jsx)(i.E,{variant:"outline",children:(null==(a=e.network_config)?void 0:a.max_retries)||0})})}),(0,n.jsx)(A.nA,{children:(0,n.jsx)("div",{className:"flex items-center space-x-2",children:"vertex"!==e.name&&"ollama"!==e.name?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(P.A,{className:"text-muted-foreground h-4 w-4"}),(0,n.jsxs)("span",{className:"text-sm",children:[(null==(r=e.keys)?void 0:r.length)||0," keys"]})]}):(0,n.jsx)("span",{className:"text-sm",children:"N/A"})})}),(0,n.jsx)(A.nA,{className:"text-right",children:(0,n.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,n.jsx)(k.$,{variant:"outline",size:"sm",onClick:()=>g(e),children:(0,n.jsx)(z.A,{className:"h-4 w-4"})}),(0,n.jsxs)(V,{children:[(0,n.jsx)(R,{asChild:!0,children:(0,n.jsx)(k.$,{variant:"outline",size:"sm",disabled:u===e.name,children:u===e.name?(0,n.jsx)(f.A,{className:"h-4 w-4 animate-spin"}):(0,n.jsx)(E.A,{className:"h-4 w-4"})})}),(0,n.jsxs)(B,{children:[(0,n.jsxs)(L,{children:[(0,n.jsx)(D,{children:"Delete Provider"}),(0,n.jsxs)($,{children:["Are you sure you want to delete provider ",e.name,"? This action cannot be undone."]})]}),(0,n.jsxs)(O,{children:[(0,n.jsx)(K,{children:"Cancel"}),(0,n.jsx)(U,{onClick:()=>p(e.name),children:"Delete"})]})]})]})]})})]},e.name)})]})]})})]})}var em=t(968);function ex(e){let{className:s,...t}=e;return(0,n.jsx)(em.b,{"data-slot":"label",className:(0,p.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...t})}let eh={name:"",connection_type:"http",connection_string:"",stdio_config:{command:"",args:[],envs:[]},tools_to_skip:[],tools_to_execute:[]},ep=e=>{var s,t,r,i,l,c;let{client:o,open:d,onClose:x,onSaved:h}=e,[p,g]=(0,a.useState)(eh),[f,v]=(0,a.useState)(!1),[w,A]=(0,a.useState)(""),[S,P]=(0,a.useState)(""),[z,E]=(0,a.useState)(""),[q,I]=(0,a.useState)(""),{toast:V}=u();(0,a.useEffect)(()=>{if(o){var e,s,t,n,a;g({name:o.name,connection_type:o.config.connection_type,connection_string:o.config.connection_string||"",stdio_config:{command:(null==(e=o.config.stdio_config)?void 0:e.command)||"",args:(null==(s=o.config.stdio_config)?void 0:s.args)||[],envs:(null==(t=o.config.stdio_config)?void 0:t.envs)||[]},tools_to_skip:o.config.tools_to_skip||[],tools_to_execute:o.config.tools_to_execute||[]}),A(((null==(n=o.config.stdio_config)?void 0:n.args)||[]).join(", ")),P(((null==(a=o.config.stdio_config)?void 0:a.envs)||[]).join(", ")),E((o.config.tools_to_skip||[]).join(", ")),I((o.config.tools_to_execute||[]).join(", "))}else g(eh),A(""),P(""),E(""),I("")},[o]);let R=(e,s)=>{g(t=>({...t,[e]:s}))},T=(e,s)=>{g(t=>({...t,stdio_config:{...t.stdio_config,[e]:s}}))},M=new ea([ea.required(null==(s=p.name)?void 0:s.trim(),"Client name is required"),ea.pattern(p.name||"",/^[a-zA-Z0-9-_]+$/,"Client name can only contain letters, numbers, hyphens and underscores"),ea.minLength(p.name||"",3,"Client name must be at least 3 characters"),ea.maxLength(p.name||"",50,"Client name cannot exceed 50 characters"),...("http"===p.connection_type||"sse"===p.connection_type)&&!o?[ea.required(null==(t=p.connection_string)?void 0:t.trim(),"Connection URL is required"),ea.pattern(p.connection_string||"",/^(http:\/\/|https:\/\/|env\.[A-Z_]+$)/,"Connection URL must start with http://, https://, or be an environment variable (env.VAR_NAME)")]:[],..."stdio"===p.connection_type&&!o?[ea.required(null==(i=p.stdio_config)||null==(r=i.command)?void 0:r.trim(),"Command is required for STDIO connections"),...!o?[ea.pattern((null==(l=p.stdio_config)?void 0:l.command)||"",/^[^<>|&;]+$/,"Command cannot contain special shell characters")]:[]]:[],...q.trim()?[ea.pattern(q,/^[a-zA-Z0-9_,-\s]+$/,"Tools to execute can only contain letters, numbers, underscores, and commas")]:[],...z.trim()?[ea.pattern(z,/^[a-zA-Z0-9_,-\s]+$/,"Tools to skip can only contain letters, numbers, underscores, and commas")]:[],...o?[ea.custom(!C(p.tools_to_execute||[],_(q))||!C(p.tools_to_skip||[],_(z)),"No changes to save")]:[],ea.custom(!((e,s)=>{let t=new Set(_(e)),n=new Set(_(s));return Array.from(t).some(e=>n.has(e))})(q,z),"Tools cannot appear in both execute and skip lists")]),B=async()=>{v(!0);let e=null,s={...p,stdio_config:"stdio"===p.connection_type?{...p.stdio_config,args:_(w),envs:_(S)}:void 0,tools_to_skip:_(z),tools_to_execute:_(q)};if(o){let t={tools_to_execute:s.tools_to_execute,tools_to_skip:s.tools_to_skip};[,e]=await m.K.updateMCPClient(o.name,t)}else[,e]=await m.K.createMCPClient(s);v(!1),e?V({title:"Error",description:e,variant:"destructive"}):(V({title:"Success",description:o?"Client updated":"Client created"}),h(),x())};return(0,n.jsx)(F.lG,{open:d,onOpenChange:x,children:(0,n.jsxs)(F.Cf,{className:"max-h-[90vh] max-w-2xl overflow-y-auto",children:[(0,n.jsx)(F.c7,{children:(0,n.jsx)(F.L3,{children:o?"Edit MCP Client Tools":"New MCP Client"})}),(0,n.jsxs)(y.Fc,{children:[(0,n.jsx)(j.A,{className:"h-4 w-4"}),(0,n.jsxs)(y.TN,{children:[(0,n.jsx)("strong",{children:"Performance Notice:"})," This operation may temporarily increase latency for incoming requests while being processed."]})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(ex,{children:"Name"}),(0,n.jsx)(b.p,{value:p.name,onChange:e=>R("name",e.target.value),placeholder:"Client name",disabled:!!o})]}),!o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"w-full space-y-2",children:[(0,n.jsx)(ex,{children:"Connection Type"}),(0,n.jsxs)(Z.l6,{value:p.connection_type,onValueChange:e=>R("connection_type",e),children:[(0,n.jsx)(Z.bq,{className:"w-full",children:(0,n.jsx)(Z.yv,{placeholder:"Select connection type"})}),(0,n.jsxs)(Z.gC,{children:[(0,n.jsx)(Z.eb,{value:"http",children:"HTTP (Streamable)"}),(0,n.jsx)(Z.eb,{value:"sse",children:"Server-Sent Events (SSE)"}),(0,n.jsx)(Z.eb,{value:"stdio",children:"STDIO"})]})]})]}),("http"===p.connection_type||"sse"===p.connection_type)&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex w-fit items-center gap-1",children:[(0,n.jsx)(ex,{children:"Connection URL"}),(0,n.jsx)(H.Bc,{children:(0,n.jsxs)(H.m_,{children:[(0,n.jsx)(H.k$,{asChild:!0,children:(0,n.jsx)("span",{children:(0,n.jsx)(G.A,{className:"text-muted-foreground ml-1 h-3 w-3"})})}),(0,n.jsx)(H.ZI,{className:"max-w-fit",children:(0,n.jsxs)("p",{children:["Use ",(0,n.jsx)("code",{className:"rounded bg-neutral-100 px-1 py-0.5 text-neutral-800",children:"env.<VAR>"})," to read the value from an environment variable."]})})]})})]}),(0,n.jsx)(b.p,{value:p.connection_string||"",onChange:e=>R("connection_string",e.target.value),placeholder:"http://your-mcp-server:3000 or env.MCP_SERVER_URL"})]}),"stdio"===p.connection_type&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(ex,{children:"Command"}),(0,n.jsx)(b.p,{value:(null==(c=p.stdio_config)?void 0:c.command)||"",onChange:e=>T("command",e.target.value),placeholder:"node, python, /path/to/executable"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(ex,{children:"Arguments (comma-separated)"}),(0,n.jsx)(b.p,{value:w,onChange:e=>A(e.target.value),placeholder:"--port, 3000, --config, config.json"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(ex,{children:"Environment Variables (comma-separated)"}),(0,n.jsx)(b.p,{value:S,onChange:e=>P(e.target.value),placeholder:"API_KEY, DATABASE_URL"})]})]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(ex,{children:"Tools to Execute (comma-separated, leave empty for all)"}),(0,n.jsx)(N,{value:q,onChange:e=>I(e.target.value),placeholder:"tool1, tool2, tool3",rows:2})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(ex,{children:"Tools to Skip (comma-separated)"}),(0,n.jsx)(N,{value:z,onChange:e=>E(e.target.value),placeholder:"skipTool1, skipTool2",rows:2})]})]}),(0,n.jsxs)(F.Es,{children:[(0,n.jsx)(k.$,{variant:"outline",onClick:x,disabled:f,children:"Cancel"}),(0,n.jsx)(H.Bc,{children:(0,n.jsxs)(H.m_,{children:[(0,n.jsx)(H.k$,{asChild:!0,children:(0,n.jsx)("span",{children:(0,n.jsx)(k.$,{onClick:B,disabled:!M.isValid()||f,isLoading:f,children:o?"Save":"Create"})})}),!M.isValid()&&(0,n.jsx)(H.ZI,{children:M.getFirstError()||"Please fix validation errors"})]})})]})]})})};var eg=t(4109),ef=t(9917);function ej(){let[e,s]=(0,a.useState)([]),[t,r]=(0,a.useState)(null),[l,c]=(0,a.useState)(!1),{toast:o}=u(),d=async()=>{let[e,t]=await m.K.getMCPClients();t?o({title:"Error",description:t,variant:"destructive"}):s(e||[])};(0,a.useEffect)(()=>{d()},[]);let h=e=>{r(e),c(!0)},p=async e=>{let[,s]=await m.K.reconnectMCPClient(e.name);s?o({title:"Error",description:s,variant:"destructive"}):(o({title:"Reconnected",description:"Client reconnected."}),d())},g=async e=>{let[,s]=await m.K.deleteMCPClient(e.name);s?o({title:"Error",description:s,variant:"destructive"}):(o({title:"Deleted",description:"Client removed."}),d())},f=e=>{if("stdio"===e.config.connection_type){var s,t;return(null==(s=e.config.stdio_config)?void 0:s.command)+" "+(null==(t=e.config.stdio_config)?void 0:t.args.join(" "))||"STDIO"}return e.config.connection_string||"".concat(e.config.connection_type.toUpperCase())},j=e=>{switch(e){case"http":return"HTTP";case"sse":return"SSE";case"stdio":return"STDIO";default:return e.toUpperCase()}};return(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)(x.aR,{className:"mb-4 px-0",children:[(0,n.jsxs)(x.ZB,{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"flex items-center gap-2",children:"Registered Clients"}),(0,n.jsxs)(k.$,{onClick:()=>{r(null),c(!0)},children:[(0,n.jsx)(S.A,{className:"h-4 w-4"})," New Client"]})]}),(0,n.jsx)(x.BT,{children:"Manage clients that can connect to the MCP Tools endpoint."})]}),(0,n.jsx)("div",{className:"rounded-md border",children:(0,n.jsxs)(A.XI,{children:[(0,n.jsx)(A.A0,{children:(0,n.jsxs)(A.Hj,{children:[(0,n.jsx)(A.nd,{children:"Name"}),(0,n.jsx)(A.nd,{children:"Connection Type"}),(0,n.jsx)(A.nd,{children:"Connection Info"}),(0,n.jsx)(A.nd,{children:"State"}),(0,n.jsx)(A.nd,{className:"text-right",children:"Actions"})]})}),(0,n.jsxs)(A.BF,{children:[0===e.length&&(0,n.jsx)(A.Hj,{children:(0,n.jsx)(A.nA,{colSpan:5,className:"py-6 text-center",children:"No clients found."})}),e.map(e=>(0,n.jsxs)(A.Hj,{children:[(0,n.jsx)(A.nA,{className:"font-medium",children:e.name}),(0,n.jsx)(A.nA,{children:j(e.config.connection_type)}),(0,n.jsx)(A.nA,{className:"max-w-72 overflow-hidden text-ellipsis whitespace-nowrap",children:f(e)}),(0,n.jsx)(A.nA,{children:(0,n.jsx)(i.E,{className:ec[e.state],children:e.state})}),(0,n.jsxs)(A.nA,{className:"space-x-2 text-right",children:["disconnected"===e.state?(0,n.jsx)(k.$,{variant:"ghost",size:"icon",onClick:()=>p(e),children:(0,n.jsx)(eg.A,{className:"h-4 w-4"})}):"connected"===e.state&&(0,n.jsx)(k.$,{variant:"ghost",size:"icon",onClick:()=>h(e),children:(0,n.jsx)(ef.A,{className:"h-4 w-4"})}),(0,n.jsxs)(V,{children:[(0,n.jsx)(R,{asChild:!0,children:(0,n.jsx)(k.$,{variant:"ghost",size:"icon",disabled:"error"===e.state,children:(0,n.jsx)(E.A,{className:"h-4 w-4"})})}),(0,n.jsxs)(B,{children:[(0,n.jsxs)(L,{children:[(0,n.jsx)(D,{children:"Remove MCP Client"}),(0,n.jsxs)($,{children:["Are you sure you want to remove MCP client ",e.name,"? You will need to reconnect the client to continue using it."]})]}),(0,n.jsxs)(O,{children:[(0,n.jsx)(K,{children:"Cancel"}),(0,n.jsx)(U,{onClick:()=>g(e),children:"Delete"})]})]})]})]})]},e.name))]})]})}),l&&(0,n.jsx)(ep,{open:l,client:t,onClose:()=>c(!1),onSaved:()=>{c(!1),d()}})]})}var ev=t(2384);function ey(){let[e,s]=(0,a.useState)("providers"),[t,d]=(0,a.useState)(!0),[x,h]=(0,a.useState)(!0),[p,g]=(0,a.useState)([]),[f,j]=(0,a.useState)([]),{toast:v}=u();(0,a.useEffect)(()=>{y(),b()},[]);let y=async()=>{let[e,s]=await m.K.getProviders();if(d(!1),s)return void v({title:"Error",description:s,variant:"destructive"});g((null==e?void 0:e.providers)||[])},b=async()=>{let[e,s]=await m.K.getMCPClients();if(h(!1),s)return void v({title:"Error",description:s,variant:"destructive"});j(e||[])};return(0,n.jsx)("div",{className:"bg-background",children:t||x?(0,n.jsx)(ev.A,{}):(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold",children:"Configuration"}),(0,n.jsx)("p",{className:"text-muted-foreground mt-2",children:"Configure AI providers, API keys, and system settings for your Bifrost instance."})]}),(0,n.jsxs)(r.tU,{value:e,onValueChange:s,className:"space-y-6",children:[(0,n.jsxs)(r.j7,{className:"grid h-12 w-full grid-cols-3",children:[(0,n.jsxs)(r.Xi,{value:"providers",className:"flex items-center gap-2",children:[(0,n.jsx)(l.A,{className:"h-4 w-4"}),"Providers",(0,n.jsx)(i.E,{variant:"default",className:"ml-1",children:p.length})]}),(0,n.jsxs)(r.Xi,{value:"mcp",className:"flex items-center gap-2",children:[(0,n.jsx)(c.A,{className:"h-4 w-4"}),"MCP Clients",f.length>0&&(0,n.jsx)(i.E,{variant:"default",className:"ml-1",children:f.length})]}),(0,n.jsxs)(r.Xi,{value:"core",className:"flex items-center gap-2",children:[(0,n.jsx)(o.A,{className:"h-4 w-4"}),"Core Settings"]})]}),(0,n.jsx)(r.av,{value:"providers",className:"space-y-4",children:(0,n.jsx)(eu,{providers:p,onRefresh:y})}),(0,n.jsx)(r.av,{value:"mcp",className:"space-y-4",children:(0,n.jsx)(ej,{})}),(0,n.jsx)(r.av,{value:"core",className:"space-y-4",children:(0,n.jsx)(w,{})})]})]})})}},7777:(e,s,t)=>{"use strict";t.d(s,{Bc:()=>i,ZI:()=>o,k$:()=>c,m_:()=>l});var n=t(5155);t(2115);var a=t(9613),r=t(3999);function i(e){let{delayDuration:s=0,...t}=e;return(0,n.jsx)(a.Kq,{"data-slot":"tooltip-provider",delayDuration:s,...t})}function l(e){let{...s}=e;return(0,n.jsx)(i,{children:(0,n.jsx)(a.bL,{"data-slot":"tooltip",...s})})}function c(e){let{...s}=e;return(0,n.jsx)(a.l9,{"data-slot":"tooltip-trigger",...s})}function o(e){let{className:s,sideOffset:t=0,children:i,...l}=e;return(0,n.jsx)(a.ZL,{children:(0,n.jsxs)(a.UC,{"data-slot":"tooltip-content",sideOffset:t,className:(0,r.cn)("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",s),...l,children:[i,(0,n.jsx)(a.i3,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}},8835:(e,s,t)=>{Promise.resolve().then(t.bind(t,12))}},e=>{var s=s=>e(e.s=s);e.O(0,[146,617,452,273,447,0,441,684,358],()=>s(8835)),_N_E=e.O()}]);